# Using NetAdapter module.

Import-Module NetAdapter
$networkAdapters = Get-NetAdapter

function Test-IPV6EnabledAdapter { 

	Param (
		[Parameter(Mandatory=$true,Position=0)]
		[string] $AdapterName
	)

	$ipv6Enabled = Get-NetAdapterBinding -Name $AdapterName | Where-Object { $_.ComponentID -eq "ms_tcpip6" }
	if ($ipv6Enabled -ne $null -and $ipv6Enabled.Enabled) {
		return $true
	} else {
		return $false
	}

}

function Show-IPV6enabledAdapters { 

	foreach ($adapter in $networkAdapters) {
	    $interfaceAlias = $adapter.Name
	   
	    # Verifica se o IPv6 está habilitado na interface
	    $ipv6Enabled = Test-IPV6EnabledAdapter -AdapterName $interfaceAlias

	    if ($ipv6Enabled -eq $true) {
	        Write-Host "[+] ${interfaceAlias} adapter : IPv6 Enabled!" -ForegroundColor Green
	    } 
	}

} 

function Disable-IPV6Adapter { 
	Param (
		[Parameter(Mandatory=$true,Position=0)]
		[string] $AdapterName
	)

	# Verifica se o IPv6 está habilitado na interface
	$ipv6Enabled = Test-IPV6EnabledAdapter -AdapterName $AdapterName

	if ($ipv6Enabled -eq $true) {
	        Write-Host "[+] ${AdapterName} adapter: Disabling IPv6!" -ForegroundColor Green
	        
	        # Desabilita o IPv6 na interface
	        Disable-NetAdapterBinding -Name $AdapterName -ComponentID "ms_tcpip6"
	    } else {
	        Write-Host "[-] ${AdapterName} adapter: IPv6 already disabled!" -ForegroundColor Red
	    }
}

function Enable-IPV6Adapter {
	
	Param (
		[Parameter(Mandatory=$true,Position=0)]
		[string] $AdapterName
	)

	Enable-NetAdapterBinding -Name $AdapterName -ComponentID "ms_tcpip6"
	Write-Host "[+] ${AdapterName} adapter: Enabling IPv6!" -ForegroundColor Green

}


function Disable-IPV6AllAdapters { 

	foreach ($adapter in $networkAdapters) {
	    $interfaceAlias = $adapter.Name

	    # Verifica se o IPv6 está habilitado na interface
	    $ipv6Enabled = Test-IPV6EnabledAdapter -AdapterName $interfaceAlias

	    if ($ipv6Enabled -eq $true) {
	        Write-Host "[+] ${interfaceAlias} adapter: Disabling IPv6!" -ForegroundColor Green
	        
	        # Desabilita o IPv6 na interface
	        Disable-NetAdapterBinding -Name $interfaceAlias -ComponentID "ms_tcpip6"
	    } else {
	        Write-Host "[-] ${interfaceAlias} adapter: IPv6 already disabled!" -ForegroundColor Red
	    }
	}


}
